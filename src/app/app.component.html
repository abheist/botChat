<mat-tab-group mat-align-tabs="center">
	<mat-tab label="DS Dashboard">
		<div fxFlex class="padding-20">
			<div fxLayout="row" fxLayoutAlign="space-between center">
				<h2>Intent Mapper</h2>
				<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="20px">
					<mat-form-field color="primary" appearance="outline">
						<input
							matInput
							[matDatepicker]="picker"
							placeholder="Choose a date"
							(dateInput)="filter()"
							[(ngModel)]="datePickerValue"
						/>
						<mat-datepicker-toggle matSuffix [for]="picker"></mat-datepicker-toggle>
						<mat-datepicker #picker></mat-datepicker>
					</mat-form-field>
					<mat-form-field color="primary" appearance="outline">
						<mat-label>Score Level</mat-label>
						<mat-select [(value)]="defaultScore" (selectionChange)="filter()">
							<mat-option *ngFor="let score of scores" [value]="score.value">
								{{ score.viewValue }}
							</mat-option>
						</mat-select>
					</mat-form-field>
					<button mat-icon-button (click)="downloadData()">
						<mat-icon>cloud_download</mat-icon>
					</button>
				</div>
			</div>
			<div fxLayout="row wrap" fxLayoutAlign="space-between start">
				<mat-accordion
					style="width: 300px; margin: 20px 0; background: #ffffff; border-radius: 8px;"
					*ngFor="let chat of allChats"
					class="mat-elevation-z0"
				>
					<mat-expansion-panel>
						<mat-expansion-panel-header>
							<mat-panel-title>
								<span class="type-badge red" *ngIf="chat.score <= 50">P</span>
								<span class="type-badge green" *ngIf="chat.score > 50">OK</span>
							</mat-panel-title>
							<mat-panel-description> Avg. chat score: {{ chat.score }} </mat-panel-description>
						</mat-expansion-panel-header>
						<div class="grey-background">
							<div style="max-height: 300px; overflow: auto; padding-left: 24px;">
								<div class="padding-vertical-5">
									<div class="mat-body-2">Timestamp:</div>
									<div class="mat-caption">{{ chat.timestamp | date }}</div>
								</div>
								<mat-divider></mat-divider>
								<div fxLayout="row">
									<div fxFlex="90">
										<div class="padding-vertical-5">
											<div class="mat-body-2">Question:</div>
											<div class="mat-caption">{{ chat.question }}</div>
										</div>
										<mat-divider></mat-divider>
										<div class="padding-vertical-5">
											<div class="mat-body-2">Answer:</div>
											<div class="mat-caption">{{ chat.answer }}</div>
										</div>
									</div>
									<div>
										<button
											mat-icon-button
											[matMenuTriggerFor]="menu"
											#menuTrigger="matMenuTrigger"
										>
											<mat-icon>chevron_right</mat-icon>
										</button>
										<mat-menu #menu="matMenu">
											<div (click)="$event.stopPropagation()">
												<p style="padding: 0 16px; font-weight: 700;">Add to Intent</p>
												<mat-divider></mat-divider>
												<div style="padding: 10px 16px;">
													<div style="padding: 7px;">{{ chat.question }}</div>
													<div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
														<mat-form-field appearance="outline">
															<mat-label>Select Intent</mat-label>
															<mat-select [(ngModel)]="chat.intent">
																<mat-option
																	*ngFor="let intent of dropdownMenu"
																	[value]="intent.value"
																>
																	{{ intent.viewValue }}
																</mat-option>
															</mat-select>
														</mat-form-field>
														<button
															mat-icon-button
															(click)="saveTheData(chat.id); menuTrigger.closeMenu()"
														>
															<mat-icon>save</mat-icon>
														</button>
													</div>
												</div>
											</div>
										</mat-menu>
									</div>
								</div>
								<mat-divider></mat-divider>
								<div class="padding-vertical-5">
									<div class="mat-body-2">Score:</div>
									<div class="mat-caption">{{ chat.score }}</div>
								</div>
							</div>
						</div>
					</mat-expansion-panel>
				</mat-accordion>
			</div>
		</div>
	</mat-tab>
	<mat-tab label="Management Dashboard">
		<mat-tab-group mat-align-tabs="center" color="primary" style="background: #fff;">
			<mat-tab mat-stretch-tabs class="second-nav" *ngFor="let report of dashboards" label="{{ report.name }}">
				<iframe
					width="100%"
					class="height-dashboard"
					[src]="report.url | safe"
					frameborder="0"
					allowFullScreen="true"
				></iframe>
			</mat-tab>
		</mat-tab-group>
	</mat-tab>
	<mat-tab label="Admin Dashboard">
		<!-- <embed src="https://portal.azure.com/#@ssaadminssainfosystems.onmicrosoft.com/dashboard/arm/subscriptions/401e0ead-f474-4d6a-a107-b970d52fd8cc/resourcegroups/ia_resourcdgroup/providers/microsoft.portal/dashboards/f358923d-747c-4eff-a0a8-252356c6b8a7-dashboard&output=embed"></!-->
		<embed src="https://portal.azure.com/#@ssaadminssainfosystems.onmicrosoft.com/dashboard/arm/subscriptions/401e0ead-f474-4d6a-a107-b970d52fd8cc/resourcegroups/ia_resourcdgroup/providers/microsoft.portal/dashboards/f358923d-747c-4eff-a0a8-252356c6b8a7-dashboard&output=embed" />
	</mat-tab>
</mat-tab-group>
